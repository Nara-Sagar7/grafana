
<div class="gf-form-query">
	<div class="gf-form">
    <label class="gf-form-label gf-form-query-letter-cell">
      <a class="pointer" tabindex="1" ng-click="ctrl.toggleCollapse()">
        <span  ng-class="{muted: !ctrl.canCollapse}" class="gf-form-query-letter-cell-carret">
          <i class="fa fa-caret-down" ng-hide="ctrl.collapsed"></i>
          <i class="fa fa-caret-right" ng-show="ctrl.collapsed"></i>
        </span>
        <span class="gf-form-query-letter-cell-letter">{{ctrl.target.refId}}</span>
        <em class="gf-form-query-letter-cell-ds" ng-show="ctrl.target.datasource">({{ctrl.target.datasource}})</em>
      </a>
		</label>
  </div>

	<div class="gf-form-query-content gf-form-query-content--collapsed" ng-if="ctrl.collapsed">
		<div class="gf-form">
			<label class="gf-form-label pointer gf-form-label--grow" ng-click="ctrl.toggleCollapse()">
				{{ctrl.collapsedText}}
			</label>
		</div>
	</div>

	<div ng-transclude class="gf-form-query-content" ng-if="!ctrl.collapsed">
	</div>

	<div class="gf-form">
		<label class="gf-form-label dropdown" ng-show="!ctrl.queryCtrl.target.textEditor">
			<a tabindex="1">
				<a class="pointer dropdown-toggle" data-toggle="dropdown">{{ctrl.queryCtrl.dataview.firstDisplayed}}</a>
				<span ng-show="!ctrl.queryCtrl.dataview.editing" edit-dataview-value>{{ctrl.queryCtrl.dataview.variable}}</span>
				<input type="text" ng-model="ctrl.queryCtrl.dataview.variable" style="display: none;">
				<a class="pointer dropdown-toggle" data-toggle="dropdown">{{ctrl.queryCtrl.dataview.lastDisplayed}}</a>
			</a>
			<ul class="dropdown-menu pull-right" role="menu">
				<li role="menuitem" ng-repeat="view in ctrl.queryCtrl.dataviews">
					<a tabindex="1" ng-click="ctrl.queryCtrl.updateDataview(view)">{{view.name}}</a>
				</li>
				<li role="menuitem" style="border-top: solid thin whitesmoke;">
					<a tabindex="1" href="https://www.hostedgraphite.com/docs/advanced/data-views.html" target="_new"><span href="" class="fa fa-info-circle"></span> what are data views?</a>
				</li>
			</ul>
		</label>
		<label class="gf-form-label dropdown">
			<a class="pointer dropdown-toggle" data-toggle="dropdown" tabindex="1">
				<i class="fa fa-bars"></i>
			</a>
			<ul class="dropdown-menu pull-right" role="menu">
				<li role="menuitem" ng-if="ctrl.hasTextEditMode">
					<a tabindex="1" ng-click="ctrl.toggleEditorMode()">Toggle Edit Mode</a>
				</li>
				<li role="menuitem">
					<a tabindex="1" ng-click="ctrl.duplicateQuery()">Duplicate</a>
				</li>
				<li role="menuitem">
					<a tabindex="1" ng-click="ctrl.moveQuery(-1)">Move up</a>
				</li>
				<li role="menuitem">
					<a tabindex="1" ng-click="ctrl.moveQuery(1)">Move down</a>
				</li>
			</ul>
		</label>
    <label class="gf-form-label">
			<a ng-click="ctrl.toggleHideQuery()" role="menuitem">
				<i class="fa fa-eye"></i>
			</a>
		</label>
		<label class="gf-form-label">
			<a class="pointer" tabindex="1" ng-click="ctrl.removeQuery(ctrl.target)">
				<i class="fa fa-trash"></i>
			</a>
		</label>
	</div>
</div>

